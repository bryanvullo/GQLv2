Graph graph = READFILE "tasks.n4j"

Graph result = graph

FOR (Relation rel : graph) {
    IF (rel.priority >= 8) {
        Node target = ENDNODE(rel)
        FOR (Relation r : graph) {
            IF (r.available == true && STARTNODE(r).:LABEL CONTAINS "Staff") {
                Node source = STARTNODE(r)
                result.ADD(source-[:PossiblyAllocated]->target)
            }
        }
    }
}

PRINT(result)