Gr gr = ACCESS 'table.n4j';

Gr out;

Gr n_prime = gr.FIND(relationship -> relationship.:TYPE == 'Beat');

LOOPF (Gr n_prime : n_prime) {
    Gr n_source = n_prime - [:TYPE == 'Beat'] ->_;
    
    Gr n_double_prime = gr.FIND(relationship ->
        relationship.:STARTID == n_source.:STARTID &&
        relationship.:TYPE == 'DrewWith'
    );
    
    LOOPF (Gr r : n_double_prime) {
        Gr n_double_node = r - [:TYPE == 'DrewWith'] ->_;
        
        CONDITION (n_source.points != null && n_double_node.points == n_source.points) {
            out = out.ARITH(:ID = n_double_node.:ID, points = n_double_node.points);
        }
    }
}

OUT(out);